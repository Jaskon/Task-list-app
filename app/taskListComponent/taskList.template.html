<!-- Form for adding a new task -->
<form class="form-inline form-add-task">
    <!-- Severity -->
    <select class="form-control" ng-model="taskToCreate.severity">
        <option value="1" selected disabled hidden>Choose severity</option>
        <option ng-repeat="task in tasks | orderBy:'severity' | unique:'severity' " value="{{task.severity}}">
            Severity {{task.severity}}</option>
        <option value="{{(tasks | max: 'severity').severity + 1}}">
            Severity {{(tasks | max: 'severity').severity + 1}}</option>
    </select>
    <!-- Between severities checkbox -->
    <div class="form-group" title="If you want to be able to paste task with identical severity - don't check this.">
        <input type="checkbox" id="between" ng-model="betweenSeverities">
        <label for="between">Between others</label>
    </div>
    <!-- Text -->
    <input type="text" class="form-control" ng-model="taskToCreate.text" placeholder="Enter task text here">
    <!-- Create button -->
    <button class="form-control btn btn-success" id="btnCreateTask" ng-click="createTask()">Create task</button>
</form>


<!-- Table - list of tasks -->
<table id="tasksTable" class="table table-striped table-hover table-tasks">
    <caption></caption>
    <thead>
        <tr class="active">
            <th id="taskSeverityTh">Severity</td>
            <th id="taskTextTh">Task</td>
            <th id="taskActionsTh">Actions</td>
            <th id="taskCompletedTh">Completed</td>
        </tr>
    </thead>

    <tbody>
        <tr ng-repeat="task in tasks | orderBy:'severity'" class="table-task-row">

            <!-- Severity -->
            <td class="col-xs-2">
                <span ng-if="!task.editing">
                    {{task.severity}}
                </span>

                <select ng-if="task.editing" class="form-control" ng-model="tempTask.severity">
                    <option ng-repeat="taskOpt in tasks | orderBy:'severity' | unique:'severity'"
                            value="{{taskOpt.severity}}" ng-selected="taskOpt.severity == task.severity">
                        Severity {{taskOpt.severity}}</option>
                    <option value="{{(tasks | max: 'severity').severity + 1}}"
                            ng-if="task.severity != (tasks | max: 'severity').severity ||
                            !(tasks | isUnique: 'severity':task.severity)">
                        Severity {{(tasks | max: 'severity').severity + 1}}</option>
                </select>
            </td>

            <!-- Text -->
            <td class="col-xs-5">
                <span ng-if="!task.editing">
                    <s ng-if="task.completed" class="taskText">{{task.text}}</s>
                    <span ng-if="!task.completed" class="taskText">{{task.text}}</span>
                </span>

                <textarea ng-if="task.editing" ng-model="tempTask.text" class="form-control" rows="1"></textarea>
            </td>

            <!-- Buttons -->
            <td class="col-xs-3">
                <span ng-if="!task.editing">
                    <button class="btn btn-info" ng-click="editTask(task)">Edit</button>
                    <button class="btn btn-danger" ng-click="deleteTask(task)">Delete</button>
                </span>

                <span ng-if="task.editing">
                    <button class="btn btn-primary" ng-click="saveEditTask(task)">Save</button>
                    <button class="btn btn-default" ng-click="cancelEditTask(task)">Cancel</button>
                </span>
            </td>

            <!-- Completed check -->
            <td class="col-xs-2">
                <input type="checkbox" ng-model="task.completed" ng-click="changeCompleteState(task)">
            </td>
        </tr>
    </tbody>
</table>